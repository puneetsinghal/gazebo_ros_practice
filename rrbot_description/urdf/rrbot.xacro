<?xml version="1.0"?>
<!-- Revolute-Revolute Manipulator -->
<robot name="rrbot" xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!-- Constants for robot dimensions -->
  <xacro:property name="PI" value="3.1415926535897931"/>
  <xacro:property name="mass" value="1" /> <!-- arbitrary value for mass -->
  <xacro:property name="width" value="0.1" /> <!-- Square dimensions (widthxwidth) of beams -->
  <xacro:property name="height1" value="2" /> <!-- Link 1 -->
  <xacro:property name="height2" value="1" /> <!-- Link 2 -->
  <xacro:property name="height3" value="1" /> <!-- Link 3 -->
  <xacro:property name="camera_link" value="0.05" /> <!-- Size of square 'camera' box -->
  <xacro:property name="axel_offset" value="0.05" /> <!-- Space btw top of beam and the each joint -->

  <!-- Import all Gazebo-customization elements, including Gazebo colors -->
  <xacro:include filename="$(find rrbot_description)/urdf/rrbot.gazebo" />
  <!-- Import Rviz colors -->
  <xacro:include filename="$(find rrbot_description)/urdf/materials.xacro" />

  <!-- measurements in 10 cm --> 

<!--Links @NEED TO ADD MASS PROPERTIES-->
  <!-- BASE LINK -->
  <!-- <link name = "base_link">
    <visual>
      <geometry>
        <sphere radius="0.016989"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <sphere radius="0.016989"/>
      </geometry>

    </collision>

    <inertial>
      <origin xyz="0 0 0.01197737" rpy="0 0 0"/>
      <mass value="0.04745029"/>
      <inertia ixx="0.03542" ixy="0.0" ixz="0.0" iyy="0.03542" iyz="0.0" izz="0.02265"/>
    </inertial>
  </link> -->

  <!--HEAD LINK  -->
  <link name="world"/>

  <link name = "hipJoint">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/singleleghipjoint.dae"/>
      </geometry>
      <material name ="black" />
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/singleleghipjoint.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </collision>
   <!--  <inertial>
      <origin xyz="-0.077506068 -0.001193546 -0.369502182" rpy="0 0 0"/>
      <mass value="0.02883033104"/>
      <inertia ixx="0.00757" ixy="0.0" ixz="0.0" iyy="0.212" iyz="0.0" izz="0.21199"/>
    </inertial> -->
  </link>



  <joint name="fixed" type="fixed">
    <!-- <limit effort="0" lower="-100" upper="100" velocity="2"/> -->
    <parent link="world"/>
    <child link="hipJoint"/>
    <origin xyz="0 0 1" rpy="0 0 0"/>
  </joint>

<xacro:macro name="leg" params="prefix reflect">

  <!-- PART 6 FOR 3 PORTIONS -->
<!--   <link name = "${prefix}_part_06">
    <visual>
      <geometry>
        <cylinder length=".25718" radius=".00955"/>
      </geometry> 
      <origin xyz="0 0 -0.12859" rpy="0 0 0"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length=".25718" radius=".00955"/>
      </geometry> 
      <origin xyz="0 0 -0.12859" rpy="0 0 0"/>
    </collision>
    <inertial>
      <origin xyz="0.033638744 0.017351756 0.011676888" rpy="0 0 0"/>
      <mass value="0.074253071"/>
      <inertia ixx="1.03428" ixy="0.02083" ixz="0.20161" iyy="1.06391" iyz="0.10400" izz="0.32225"/>
    </inertial>

  </link> -->

  <!-- PART 5 FOR 3 PORTIONS-->
<!-- 
  <link name ="${prefix}_part_05">
    <visual>
      <geometry>
        <cylinder length=".076091" radius=".003175"/>
      </geometry>
      <origin xyz="0 0 -0.0380455" rpy="0 0 0"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length=".076091" radius=".003175"/>
      </geometry>
      <origin xyz="0 0 -0.0380455" rpy="0 0 0"/>
    </collision>
    <inertial>
      <origin xyz="0.047697136 0.009792716 0.16353663" rpy="0 0 0"/>
      <mass value="0.05313834615"/>
      <inertia ixx="0.13237" ixy="0.01154" ixz="-0.02820" iyy="0.12116" iyz="-0.04452" izz="0.03887"/>
    </inertial>
  </link> -->

  <!-- PART 4 FOR 3 PORTIONS -->
<!--   <link name="${prefix}_part_04">
    <visual>
      <geometry>
        <cylinder length=".147481" radius=".00955"/>
      </geometry>
      <origin xyz="0 0 -0.0737405" rpy="0 0 0"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length=".147481" radius=".00955"/>
      </geometry>
      <origin xyz="0 0 -0.0737405" rpy="0 0 0"/>
    </collision>
    <inertial>
      <origin xyz="0.04675124 0.001219962 0.199093582" rpy="0 0 0"/>
      <mass value="0.07071051456"/>
      <inertia ixx="0.61894" ixy="0.00140" ixz="0.03807" iyy="0.62157" iyz="0.02201" izz="0.01643"/>
    </inertial>
  </link> -->


  <!-- PART 2 FOR 3 PORTIONS -->
  <link name="${prefix}_pipebetweenhipandmotormountingbracket">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/pipebetweenhipandmotormountingbracket.dae"/>
      </geometry>
      <material name = "blue" />
      <origin xyz="0 0 0" rpy="0 0 ${-PI/2}"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/pipebetweenhipandmotormountingbracket.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 ${-PI/2}"/>
    </collision>
  </link>

  <link name="${prefix}_motormountingbracket_fixed">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/motormountingbracket_fixed.dae"/>
      </geometry>
      <material name = "blue" />
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/motormountingbracket_fixed.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </collision>
  </link>

  <link name="${prefix}_upper_leg_bracket">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/upper_leg_bracket.dae"/>
      </geometry>
      <material name = "blue" />
      <origin xyz="0 0 0" rpy="0 0 ${PI/2}"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/upper_leg_bracket.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 ${PI/2}"/>
    </collision>
  </link>

    <link name="${prefix}_upper_leg">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/upper_leg.dae"/>
      </geometry>
      <material name = "blue" />
      <origin xyz="0 0 0" rpy="0 0 ${-PI/2}"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/upper_leg.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 ${-PI/2}"/>
    </collision>
  </link>

  <link name="${prefix}_eyeJoint">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/eye_joint.dae"/>
      </geometry>
      <material name = "blue" />
      <origin xyz="0 0 0" rpy="0 0 ${PI/2}"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/eye_joint.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 ${PI/2}"/>
    </collision>
  </link>

  <link name="${prefix}_sphericalJointMiddleLink">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/spherical_joint_middle_piece.dae"/>
      </geometry>
      <material name = "blue" />
      <origin xyz="0 0 0" rpy="0 0 ${PI/2}"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/spherical_joint_middle_piece.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 ${PI/2}"/>
    </collision>
  </link>

  <link name="${prefix}_bendElbow">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/elbow_bend.dae"/>
      </geometry>
      <material name = "blue" />
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/elbow_bend.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </collision>
  </link>

  <link name="${prefix}_lowerLeg">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/lower_leg.dae"/>
      </geometry>
      <material name = "blue" />
      <origin xyz="0 0 0" rpy="0 0 ${-PI/2}"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/lower_leg.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 ${-PI/2}"/>
    </collision>
  </link>

  <link name="${prefix}_footBracket">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/foot_bracket.dae"/>
      </geometry>
      <material name = "blue" />
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/foot_bracket.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </collision>
  </link>

 <!--  <link name="${prefix}_footAssembly">
    <visual>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/footassembly.dae"/>
      </geometry>
      <material name = "blue" />
      <origin xyz="0 0 0" rpy="0 0 ${PI}"/>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/footassembly.dae"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 ${PI}"/>
    </collision>
  </link> -->

  <!-- JOINTS -->

  <!-- FROM PART1 TO HEAD_LINK -->
  <joint name="${prefix}_hip_to_pipeBetweenHipAndMotorMountingBracket" type="fixed">
    <parent link="hipJoint"/>
    <child link="${prefix}_pipebetweenhipandmotormountingbracket"/>
    <origin xyz="${0.01176*cos(reflect*120*PI/180)} ${0.01176*sin(reflect*120*PI/180)}  0" rpy="0 0 ${reflect*120*PI/180}"/>
  </joint>

  <joint name="${prefix}_pipebetweenhipandmotormountingbracket_to_motor" type="fixed">
    <parent link="${prefix}_pipebetweenhipandmotormountingbracket"/>
    <child link="${prefix}_motormountingbracket_fixed"/>
    <origin xyz="0.03073 0 0" rpy="${-PI/2} 0 0"/>
  </joint>

  <joint name="${prefix}_motorMoutingBracket_to_upperLegBracket" type="revolute">
    <axis xyz="0 0 1"/>
    <!-- <pose xyz="0 0 0" rpy="0 0 0"/> -->
    <limit effort="1000.0" lower="${-PI/2}" upper="${PI/2}" velocity="0"/>
    <origin xyz="0.00864 0.06680 0.01267" rpy="0 0 0"/>
    <parent link="${prefix}_motormountingbracket_fixed"/>
    <child link="${prefix}_upper_leg_bracket"/>
  </joint>

  <joint name="${prefix}_upperLegBracket_to_upperLink" type="fixed">
    <parent link="${prefix}_upper_leg_bracket"/>
    <child link="${prefix}_upper_leg"/>
    <origin xyz="0.05166 0 -0.01150" rpy="0 0 0"/>
  </joint>

  <joint name="${prefix}_upperLeg_to_eyeJoint" type="revolute">
    <axis xyz="1 0 0"/>
    <!-- <pose xyz="0 0 0" rpy="0 0 0"/> -->
    <limit effort="1000.0" lower="${-PI}" upper="${PI}" velocity="0"/>
    <origin xyz="0.09885 0 0" rpy="0 0 0"/>
    <parent link="${prefix}_upper_leg"/>
    <child link="${prefix}_eyeJoint"/>
  </joint>

  <joint name="${prefix}_eyeJoint_to_sphericalJointMiddleLink" type="revolute">
    <axis xyz="0 0 1"/>
    <!-- <pose xyz="0 0 0" rpy="0 0 0"/> -->
    <limit effort="1000.0" lower="${-PI/2}" upper="${PI/2}" velocity="0"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <parent link="${prefix}_eyeJoint"/>
    <child link="${prefix}_sphericalJointMiddleLink"/>
  </joint>

  <joint name="${prefix}_sphericalJointMiddleLink_to_bendElbow" type="revolute">
    <axis xyz="1 0 0"/>
    <!-- <pose xyz="0 0 0" rpy="0 0 0"/> -->
    <limit effort="1000.0" lower="${-PI}" upper="${PI}" velocity="0"/>
    <origin xyz="0.01916 0 0" rpy="0 0 0"/>
    <parent link="${prefix}_sphericalJointMiddleLink"/>
    <child link="${prefix}_bendElbow"/>
  </joint>

  <joint name="${prefix}_bendElbow_to_lowerLeg" type="fixed">
    <parent link="${prefix}_bendElbow"/>
    <child link="${prefix}_lowerLeg"/>
    <origin xyz="0.06170 0.01192 0" rpy="0 0 ${47*PI/180}"/>
  </joint>

  <joint name="${prefix}_lowerLeg_footBracket" type="fixed">
    <parent link="${prefix}_lowerLeg"/>
    <child link="${prefix}_footBracket"/>
    <origin xyz="0.26032 0 0" rpy="0 0 0"/>
  </joint>
<!-- 
  <joint name="${prefix}_footassembly_to_bendElbow" type="revolute">
    <axis xyz="0 0 1"/>
    <limit effort="1000.0" lower="${-PI}" upper="${PI}" velocity="0"/>
    <origin xyz="0 0.01159 0" rpy="0 0 0"/>
    <parent link="${prefix}_footBracket"/>
    <child link="${prefix}_footAssembly"/>
  </joint> -->

  <!-- GAZEBO PLUGIN -->
  <gazebo>
    <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">
      <robotNamespace>/goatleg</robotNamespace>
    </plugin>
  </gazebo>
</xacro:macro>
<xacro:leg prefix="leg1" reflect="0" />
<xacro:leg prefix="leg2" reflect="1" />
<xacro:leg prefix="leg3" reflect="2" />

</robot>
